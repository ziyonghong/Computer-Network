## 5.链路层和局域网

两种不同类型的链路层信道： 广播信道 和 点对点通信链路

### 5.1链路层概述

运行链路层协议的任何设备称为 **节点** ，包括主机、路由器、交换机和WiFi接入点。

沿着通信路径连接相邻节点的通信信道称为 **链路**

传输节点将数据报封装在链路层帧中。

链路层的基本服务是将数据报通过单一通信链路从一个节点移动到相邻节点，服务包括：

1.封装成帧

2.链路接入

3.可靠交付，通常是通过确认和重传取得的，用于易于产生高差错率的链路

4.差错检测和纠正 （没必要转发一个有差错的数据报）



链路层的主体部分在 **网路适配器（网络接入卡）** 中实现的。



### 5.2差错检测和纠正

1.奇偶校验 /二维奇偶校验

2.校验和方法

3.循环冗余校验 （只能做到无差错接受，要做到可靠传输，必须加上确认和重传机制）



### 5.3多路访问链路和协议

点对点链路由链路一端的单个发送方和链路另一端的单个接收方组成。

广播链路，它能够让多个发送和接受节点都连接到相同的、单一的、共享的广播信道上。

多路访问问题：如何协调多个发送和接受节点对一个共享广播信道的访问？

多路访问协议：

#### 1.**信道划分协议**

将信道划分为多个更小的“片”（时隙、频段、编码）；将片分配给节点独占使用

#### 2.**随机接入协议**

不划分信道、从碰撞中“恢复”

**1.载波侦听多路访问（CSMA）**

 载波侦听，即一个节点在传输前先听信道。

碰撞检测，即当一个传输节点在传输时一直在侦听此信道，如果检测到另一个节点正在传输干扰帧，它就停止传输。

信道传播时延越大，载波侦听节点不能侦听到网络中另一个节点已经开始传输的机会就越大。

**2.具有碰撞检测的载波侦听多路访问**

在多路访问协议中加入碰撞检测，通过不传输一个无用的、损坏的帧，利于改善协议性能。



1）适配器从网络层一条获得数据报，准备链路层帧，并将其放入帧适配器缓存中

2) 如果适配器侦听到信道空闲（即无信号能量从信道进入适配器），它开始传输帧；如果信道正在忙，它就等待。

3）在传输过程中，适配器监视来自其他使用该广播信道的适配器的信号能量的存在。



**二进制指数后退**

当传输一个给定帧时，在该帧经历了一连串的n次碰撞后，节点随机地从{0，1，2，2^n-1}中选择一个K值。因此，一个帧经历的碰撞越多，K选择的回退间隔越大。 一个节点等待的实际时间量是K*512比特时间。



#### 3.**轮流协议**

